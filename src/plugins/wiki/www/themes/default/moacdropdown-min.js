function cBrowser(){var a=navigator.userAgent.toLowerCase();this.version=parseInt(navigator.appVersion);this.subVersion=parseFloat(navigator.appVersion);this.ns=((a.indexOf("mozilla")!=-1)&&((a.indexOf("spoofer")==-1)&&(a.indexOf("compatible")==-1)));this.ns2=(this.ns&&(this.version==2));this.ns3=(this.ns&&(this.version==3));this.ns4b=(this.ns&&(this.subVersion<4.04));this.ns4=(this.ns&&(this.version==4));this.ns5=(this.ns&&(this.version==5));this.ie=(a.indexOf("msie")!=-1);this.ie3=(this.ie&&(this.version==2));this.ie4=(this.ie&&(this.version==4)&&(a.indexOf("msie 4.")!=-1));this.ie5=(this.ie&&(this.version==4)&&(a.indexOf("msie 5.0")!=-1));this.ie55=(this.ie&&(this.version==4)&&(a.indexOf("msie 5.5")!=-1));this.ie6=(this.ie&&(this.version==4)&&(a.indexOf("msie 6.0")!=-1));this.op3=(a.indexOf("opera")!=-1);this.win=(a.indexOf("win")!=-1);this.mac=(a.indexOf("mac")!=-1);this.unix=(a.indexOf("x11")!=-1);this.name=navigator.appName;this.dom=this.ns5||this.ie5||this.ie55||this.ie6}var bw=new cBrowser();cDomEvent={e:null,type:"",button:0,key:0,x:0,y:0,pagex:0,pagey:0,target:null,from:null,to:null};cDomEvent.init=function(a){if(window.event){a=window.event}this.e=a;this.type=a.type;this.button=(a.which)?a.which:a.button;this.key=(a.which)?a.which:a.keyCode;this.target=(a.srcElement)?a.srcElement:a.originalTarget;this.currentTarget=(a.currentTarget)?a.currentTarget:a.srcElement;this.from=(a.originalTarget)?a.originalTarget:(a.fromElement)?a.fromElement:null;this.to=(a.currentTarget)?a.currentTarget:(a.toElement)?a.toElement:null;this.x=(a.layerX)?a.layerX:(a.offsetX)?a.offsetX:null;this.y=(a.layerY)?a.layerY:(a.offsetY)?a.offsetY:null;this.screenX=a.screenX;this.screenY=a.screenY;this.pageX=(a.pageX)?a.pageX:a.x+document.body.scrollLeft;this.pageY=(a.pageY)?a.pageY:a.y+document.body.scrollTop};cDomEvent.getEvent=function(a){if(window.event){a=window.event}return{e:a,type:a.type,button:(a.which)?a.which:a.button,key:(a.which)?a.which:a.keyCode,target:(a.srcElement)?a.srcElement:a.originalTarget,currentTarget:(a.currentTarget)?a.currentTarget:a.srcElement,from:(a.originalTarget)?a.originalTarget:(a.fromElement)?a.fromElement:null,to:(a.currentTarget)?a.currentTarget:(a.toElement)?a.toElement:null,x:(a.layerX)?a.layerX:(a.offsetX)?a.offsetX:null,y:(a.layerY)?a.layerY:(a.offsetY)?a.offsetY:null,screenX:a.screenX,screenY:a.screenY,pageX:(a.pageX)?a.pageX:(a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)),pageY:(a.pageY)?a.pageY:(a.clientY+(document.documentElement.scrollTop||document.body.scrollTop))}};cDomEvent.cancelEvent=function(a){if(a.preventDefault){a.preventDefault()}a.returnValue=false;a.cancelBubble=true;return false};cDomEvent.addEvent=function(hElement,sEvent,handler,bCapture){if(hElement.addEventListener){hElement.addEventListener(sEvent,handler,bCapture);return true}else{if(hElement.attachEvent){return hElement.attachEvent("on"+sEvent,handler)}else{if(document.all||hElement.captureEvents){if(hElement.captureEvents){eval("hElement.captureEvents( Event."+sEvent.toUpperCase()+" )")}eval("hElement.on"+sEvent+" = "+handler)}else{alert("Not implemented yet!")}}}};cDomEvent.encapsulateEvent=function(a){return function(b){b=cDomEvent.getEvent(b);a.call(b.target,b.e)}};cDomEvent.addEvent2=function(c,d,a,b){if(c){if(c.addEventListener){c.addEventListener(d,cDomEvent.encapsulateEvent(a),b);return true}else{if(c.attachEvent){return c.attachEvent("on"+d,cDomEvent.encapsulateEvent(a))}else{alert("Not implemented yet!")}}}else{}};cDomEvent.addCustomEvent2=function(b,c,a){if(b){b[c]=a}else{}};cDomEvent.removeEvent=function(hElement,sEvent,handler,bCapture){if(hElement.addEventListener){hElement.removeEventListener(sEvent,handler,bCapture);return true}else{if(hElement.attachEvent){return hElement.detachEvent("on"+sEvent,handler)}else{if(document.all||hElement.captureEvents){eval("hElement.on"+sEvent+" = null")}else{alert("Not implemented yet!")}}}};function MouseButton(){if(document.layers){this.left=1;this.middle=2;this.right=3}else{if(document.all){this.left=1;this.middle=4;this.right=2}else{this.left=0;this.middle=1;this.right=2}}}var MB=new MouseButton();if(document.ELEMENT_NODE==null){document.ELEMENT_NODE=1;document.TEXT_NODE=3}function getSubNodeByName(a,f){if(a!=null){var c=0;var e=0;var b=a.childNodes;var d=null;while(e<b.length){d=b.item(e++);if((d.nodeType==1)&&(d.nodeName.toLowerCase()==f)){return d}}}return null}function getPrevNodeSibling(a){if(a!=null){do{a=a.previousSibling}while(a!=null&&a.nodeType!=1);return a}}function getNextNodeSibling(a){if(a!=null){do{a=a.nextSibling}while(a!=null&&a.nodeType!=1);return a}}function getLastSubNodeByName(a,g){if(a!=null){var c=0;var f=0;var b=a.childNodes;var d=null;var e=b.length-1;while(e>=0){d=b.item(e);if((d.nodeType==1)&&(d.nodeName.toLowerCase()==g)){return d}e--}}return null}function getSubNodeByProperty(hNode,sProperty,sPropValue){if(hNode!=null){var nNc=0;var nC=0;var hNodeChildren=hNode.childNodes;var hCNode=null;var sAttribute;var hProp;sPropValue=sPropValue.toLowerCase();while(nC<hNodeChildren.length){hCNode=hNodeChildren.item(nC++);if(hCNode.nodeType==document.ELEMENT_NODE){hProp=eval("hCNode."+sProperty);if(typeof(sPropValue)!="undefined"){if(hProp.toLowerCase()==sPropValue){return hCNode}}else{return hCNode}}nNc++}}return null}function findAttribute(a,c){c=c.toLowerCase();for(var b=0;b<a.attributes.length;b++){if(a.attributes.item(b).nodeName.toLowerCase()==c){return a.attributes.item(b).nodeValue}}return null}function getSubNodeByAttribute(b,f,e){if(b!=null){var d=0;var h=0;var c=b.childNodes;var g=null;var a;e=e.toLowerCase();while(h<c.length){g=c.item(h++);if(g.nodeType==document.ELEMENT_NODE){a=g.getAttribute(f);if(a&&a.toLowerCase()==e){return g}}d++}}return null}function getLastSubNodeByAttribute(a,e,d){if(a!=null){var c=0;var h=0;var b=a.childNodes;var f=null;var g=b.length-1;while(g>=0){f=b.item(g);if(f.nodeType==document.ELEMENT_NODE){sAttribute=f.getAttribute(e);if(sAttribute&&sAttribute.toLowerCase()==d){return f}}g--}}return null}function getParentByTagName(a,b){while((a.tagName)&&!(/(body|html)/i.test(a.tagName))){if(a.tagName==b){return a}a=a.parentNode}return null}function getParentByAttribute(a,d,b){while((a.tagName)&&!(/(body|html)/i.test(a.tagName))){var c=a.getAttribute(d);if(c!=null&&c.toString().length>0){if(b!==null){if(c==b){return a}}else{return a}}a=a.parentNode}return null}function getParentByProperty(hNode,sProperty,sPropValue){while((hNode.tagName)&&!(/(body|html)/i.test(hNode.tagName))){var hProp=eval("hNode."+sProperty);if(hProp!=null&&hProp.toString().length>0){if(sPropValue!==null){if(hProp==sPropValue){return hNode}}else{return hNode}}hNode=hNode.parentNode}return null}function getNodeText(a){if(a==null){return""}var b;if(a.hasChildNodes()){b=a.childNodes.item(0).nodeValue}else{b=a.text}return b}function cDomExtension(a,b,c){this.hParent=a;this.aSelectors=b;this.hInitFunction=c}cDomExtensionManager={aExtensions:new Array()};cDomExtensionManager.register=function(a){cDomExtensionManager.aExtensions.push(a)};cDomExtensionManager.initSelector=function(f,i,d){var a;var c;var b;var h;var e;a=/([a-z0-9_]*)\[?([^\]]*)\]?/i;c=/([a-z0-9_]*)([\*\^\$]?)(=?)(([a-z0-9_=]*))/i;if(a.test(i)&&!/[@#\.]/.test(i)){b=a.exec(i);if(b[1]!=""){g=f.getElementsByTagName(b[1].toLowerCase());for(nI=0;nI<g.length;nI++){g[nI].markExt=true}for(nI=0;nI<g.length;nI++){if(!g[nI].markExt){continue}else{g[nI].markExt=false}if(b[2]==""){if(g[nI].tagName.toLowerCase()==b[1].toLowerCase()){d(g[nI])}}else{h=c.exec(b[2]);if(h[1]=="class"){e=g[nI].className}else{e=g[nI].getAttribute(h[1])}if(e!=null&&e.length>0){if(h[3]=="="){if(h[2]==""){if(e==h[4]){d(g[nI])}}else{switch(h[2]){case"^":if(e.indexOf(h[4])==0){d(g[nI])}break;case"$":if(e.lastIndexOf(h[4])==e.length-h[4].length){d(g[nI])}break;case"*":if(e.indexOf(h[4])>=0){d(g[nI])}break}}}else{d(g[nI])}}}}return}}a=/([a-z0-9_]*)([\.#@]?)([a-z0-9_=~]*)/i;c=/([a-z0-9_]*)([=~])?([a-z0-9_]*)/i;b=a.exec(i);if(b[1]!=""){var g=f.getElementsByTagName(b[1]);for(nI=0;nI<g.length;nI++){g[nI].markExt=true}for(nI=0;nI<g.length;nI++){if(!g[nI].markExt){continue}else{g[nI].markExt=false}if(b[2]!=""){switch(b[2]){case".":if(g[nI].className==b[3]){d(g[nI])}break;case"#":if(g[nI].id==b[3]){d(g[nI])}break;case"@":h=c.exec(b[3]);e=g[nI].getAttribute(h[1]);if(e!=null&&e.length>0){if(h[3]!=""){if(h[2]=="="){if(e==h[3]){d(g[nI])}}else{if(e.indexOf(h[3])>=0){d(g[nI])}}}else{d(g[nI])}}break}}}}};cDomExtensionManager.initialize=function(){var d=null;var c;for(var a in cDomExtensionManager.aExtensions){c=cDomExtensionManager.aExtensions[a].aSelectors;for(var b in c){cDomExtensionManager.initSelector(cDomExtensionManager.aExtensions[a].hParent,c[b],cDomExtensionManager.aExtensions[a].hInitFunction)}}};if(window.addEventListener){window.addEventListener("load",cDomExtensionManager.initialize,false)}else{if(window.attachEvent){window.attachEvent("onload",cDomExtensionManager.initialize)}}function cDomObject(a){if(bw.dom||bw.ie){this.hElement=document.getElementById(a);this.hStyle=this.hElement.style}}cDomObject.prototype.getWidth=function(){return cDomObject.getWidth(this.hElement)};cDomObject.getWidth=function(b){if(b.currentStyle){var a=parseInt(b.currentStyle.width);if(isNaN(a)){return parseInt(b.offsetWidth)}else{return a}}else{return parseInt(b.offsetWidth)}};cDomObject.prototype.getHeight=function(){return cDomObject.getHeight(this.hElement)};cDomObject.getHeight=function(b){if(b.currentStyle){var a=parseInt(b.currentStyle.height);if(isNaN(a)){return parseInt(b.offsetHeight)}else{return a}}else{return parseInt(b.offsetHeight)}};cDomObject.prototype.getLeft=function(){return cDomObject.getLeft(this.hElement)};cDomObject.getLeft=function(a){return parseInt(a.offsetLeft)};cDomObject.prototype.getTop=function(){return cDomObject.getTop(this.hElement)};cDomObject.getTop=function(a){return parseInt(a.offsetTop)};cDomObject.getOffsetParam=function(hElement,sParam,hLimitParent){var nRes=0;if(hLimitParent==null){hLimitParent=document.body.parentElement}while(hElement!=hLimitParent){nRes+=eval("hElement."+sParam);if(!hElement.offsetParent){break}hElement=hElement.offsetParent}return nRes};cDomObject.getScrollOffset=function(hElement,sParam,hLimitParent){nRes=0;if(hLimitParent==null){hLimitParent=document.body.parentElement}while(hElement!=hLimitParent){nRes+=eval("hElement.scroll"+sParam);if(!hElement.offsetParent){break}hElement=hElement.parentNode}return nRes};function getDomDocumentPrefix(){if(getDomDocumentPrefix.prefix){return getDomDocumentPrefix.prefix}var c=["MSXML2","Microsoft","MSXML","MSXML3"];var d;for(var b=0;b<c.length;b++){try{d=new ActiveXObject(c[b]+".DomDocument");return getDomDocumentPrefix.prefix=c[b]}catch(a){}}throw new Error("Could not find an installed XML parser")}function getXmlHttpPrefix(){if(getXmlHttpPrefix.prefix){return getXmlHttpPrefix.prefix}var c=["MSXML2","Microsoft","MSXML","MSXML3"];var d;for(var b=0;b<c.length;b++){try{d=new ActiveXObject(c[b]+".XmlHttp");return getXmlHttpPrefix.prefix=c[b]}catch(a){}}throw new Error("Could not find an installed XML parser")}function XmlHttp(){}XmlHttp.create=function(){try{if(window.XMLHttpRequest){var b=new XMLHttpRequest();if(b.readyState==null){b.readyState=1;b.addEventListener("load",function(){b.readyState=4;if(typeof b.onreadystatechange=="function"){b.onreadystatechange()}},false)}return b}if(window.ActiveXObject){return new ActiveXObject(getXmlHttpPrefix()+".XmlHttp")}}catch(a){}throw new Error("Your browser does not support XmlHttp objects")};function XmlDocument(){}XmlDocument.create=function(){try{if(document.implementation&&document.implementation.createDocument){var b=document.implementation.createDocument("","",null);if(b.readyState==null){b.readyState=1;b.addEventListener("load",function(){b.readyState=4;if(typeof b.onreadystatechange=="function"){b.onreadystatechange()}},false)}return b}if(window.ActiveXObject){return new ActiveXObject(getDomDocumentPrefix()+".DomDocument")}}catch(a){}throw new Error("Your browser does not support XmlDocument objects")};if(window.DOMParser&&window.XMLSerializer&&window.Node&&Node.prototype&&Node.prototype.__defineGetter__){Document.prototype.loadXML=function(b){var c=(new DOMParser()).parseFromString(b,"text/xml");while(this.hasChildNodes()){this.removeChild(this.lastChild)}for(var a=0;a<c.childNodes.length;a++){this.appendChild(this.importNode(c.childNodes[a],true))}};Document.prototype.__defineGetter__("xml",function(){return(new XMLSerializer()).serializeToString(this)})}function cAutocomplete(a){this.init(a)}var xmlrpc_url;cAutocomplete.CS_NAME="Autocomplete component";cAutocomplete.CS_OBJ_NAME="AC_COMPONENT";cAutocomplete.CS_LIST_PREFIX="ACL_";cAutocomplete.CS_BUTTON_PREFIX="ACB_";cAutocomplete.CS_INPUT_PREFIX="AC_";cAutocomplete.CS_HIDDEN_INPUT_PREFIX="ACH_";cAutocomplete.CS_INPUT_CLASSNAME="dropdown";cAutocomplete.CB_AUTOINIT=true;cAutocomplete.CB_AUTOCOMPLETE=false;cAutocomplete.CB_FORCECORRECT=false;cAutocomplete.CB_MATCHSUBSTRING=false;cAutocomplete.CS_SEPARATOR=",";cAutocomplete.CS_ARRAY_SEPARATOR=",";cAutocomplete.CB_MATCHSTRINGBEGIN=true;cAutocomplete.CN_OFFSET_TOP=2;cAutocomplete.CN_OFFSET_LEFT=-1;cAutocomplete.CN_LINE_HEIGHT=19;cAutocomplete.CN_NUMBER_OF_LINES=10;cAutocomplete.CN_HEIGHT_FIX=2;cAutocomplete.CN_CLEAR_TIMEOUT=300;cAutocomplete.CN_SHOW_TIMEOUT=400;cAutocomplete.CN_REMOTE_SHOW_TIMEOUT=1000;cAutocomplete.CN_MARK_TIMEOUT=400;cAutocomplete.hListDisplayed=null;cAutocomplete.nCount=0;cAutocomplete.autoInit=function(){var a=0;var f=null;var c;var g=document.getElementsByTagName("INPUT").length;for(a=0;a<g;a++){if(document.getElementsByTagName("INPUT")[a].type.toLowerCase()=="text"){c=document.getElementsByTagName("INPUT")[a].getAttribute("acdropdown");if(c!=null&&c.length>0){if(document.getElementsByTagName("INPUT")[a].id==null||document.getElementsByTagName("INPUT")[a].id.length==0){document.getElementsByTagName("INPUT")[a].id=cAutocomplete.CS_OBJ_NAME+cAutocomplete.nCount}f=new cAutocomplete(document.getElementsByTagName("INPUT")[a].id)}}}var b=document.getElementsByTagName("TEXTAREA").length;for(a=0;a<b;a++){c=document.getElementsByTagName("TEXTAREA")[a].getAttribute("acdropdown");if(c!=null&&c.length>0){if(document.getElementsByTagName("TEXTAREA")[a].id==null||document.getElementsByTagName("TEXTAREA")[a].id.length==0){document.getElementsByTagName("TEXTAREA")[a].id=cAutocomplete.CS_OBJ_NAME+cAutocomplete.nCount}f=new cAutocomplete(document.getElementsByTagName("TEXTAREA")[a].id)}}var e=document.getElementsByTagName("SELECT").length;var d=null;for(a=0;a<e;a++){d=document.getElementsByTagName("SELECT")[a];c=d.getAttribute("acdropdown");if(c!=null&&c.length>0){if(d.id==null||d.id.length==0){d.id=cAutocomplete.CS_OBJ_NAME+cAutocomplete.nCount}f=new cAutocomplete(d.id);e--;a--}}};if(cAutocomplete.CB_AUTOINIT){if(window.attachEvent){window.attachEvent("onload",cAutocomplete.autoInit)}else{if(window.addEventListener){window.addEventListener("load",cAutocomplete.autoInit,false)}}}cAutocomplete.prototype.init=function(sInputId){this.bDebug=false;this.sInputId=sInputId;this.sListId=cAutocomplete.CS_LIST_PREFIX+sInputId;this.sObjName=cAutocomplete.CS_OBJ_NAME+"_obj_"+(cAutocomplete.nCount++);this.hObj=this.sObjName;this.hActiveSelection=null;this.nSelectedItemIdx=-1;this.sLastActiveValue="";this.sActiveValue="";this.bListDisplayed=false;this.nItemsDisplayed=0;this.bAssociative=true;this.sHiddenInputId=null;this.bHasButton=false;this.aData=null;this.aSearchData=new Array();this.bSorted=false;this.nLastMatchLength=0;this.bForceCorrect=cAutocomplete.CB_FORCECORRECT;var sForceCorrect=document.getElementById(this.sInputId).getAttribute("autocomplete_forcecorrect");if(sForceCorrect!=null&&sForceCorrect.length>0){this.bForceCorrect=eval(sForceCorrect)}this.bMatchBegin=cAutocomplete.CB_MATCHSTRINGBEGIN;var sMatchBegin=document.getElementById(this.sInputId).getAttribute("autocomplete_matchbegin");if(sMatchBegin!=null&&sMatchBegin.length>0){this.bMatchBegin=eval(sMatchBegin)}this.bMatchSubstring=cAutocomplete.CB_MATCHSUBSTRING;var sMatchSubstring=document.getElementById(this.sInputId).getAttribute("autocomplete_matchsubstring");if(sMatchSubstring!=null&&sMatchSubstring.length>0){this.bMatchSubstring=eval(sMatchSubstring)}this.bAutoComplete=cAutocomplete.CB_AUTOCOMPLETE;this.bAutocompleted=false;var sAutoComplete=document.getElementById(this.sInputId).getAttribute("autocomplete_complete");if(sAutoComplete!=null&&sAutoComplete.length>0){this.bAutoComplete=eval(sAutoComplete)}this.formatOptions=null;var sFormatFunction=document.getElementById(this.sInputId).getAttribute("autocomplete_format");if(sFormatFunction!=null&&sFormatFunction.length>0){this.formatOptions=eval(sFormatFunction)}this.onSelect=null;var sOnSelectFunction=document.getElementById(this.sInputId).getAttribute("autocomplete_onselect");if(sOnSelectFunction!=null&&sOnSelectFunction.length>0){this.onSelect=eval(sOnSelectFunction)}if(this.getListArrayType()=="url"||this.getListArrayType()=="xmlrpc"){this.bAssociative=false;this.bRemoteList=true;this.sListURL=this.getListURL();this.hXMLHttp=XmlHttp.create();this.bXMLRPC=(this.getListArrayType()=="xmlrpc")}else{this.bRemoteList=false}var sAssociative=document.getElementById(this.sInputId).getAttribute("autocomplete_assoc");if(sAssociative!=null&&sAssociative.length>0){this.bAssociative=eval(sAssociative)}this.initListArray();this.initListContainer();this.initInput();eval(this.hObj+"= this")};cAutocomplete.prototype.initInput=function(){var g=document.getElementById(this.sInputId);g.hAutocomplete=this;var c=document.getElementById(this.sListId);c.hAutocomplete=this;var i=g.offsetWidth;if(!i||i==0){var f=g.cloneNode(true);f.style.position="absolute";f.style.top="-1000px";document.body.appendChild(f);var i=f.offsetWidth;document.body.removeChild(f)}var d=g.name;var e=g.form;var n=false;var h=g.value;var k=g.type.toLowerCase()=="text"?g.value:"";var b=g.getAttribute("autocomplete_button");if(b!=null&&b.length>0){n=true}if(g.type.toLowerCase()=="select-one"){n=true;if(g.selectedIndex>=0){h=g.options[g.selectedIndex].value;k=g.options[g.selectedIndex].text}}if(e){var j=document.createElement("INPUT");j.id=cAutocomplete.CS_HIDDEN_INPUT_PREFIX+this.sInputId;j.type="hidden";e.appendChild(j);if(this.bAssociative){j.name=d;g.name=cAutocomplete.CS_INPUT_PREFIX+d}else{j.name=cAutocomplete.CS_INPUT_PREFIX+d}j.value=h;this.sHiddenInputId=j.id}if(n){this.bHasButton=true;var l=document.createElement("DIV");l.className="acinputContainer";l.style.width=i;var a=document.createElement("INPUT");a.id=cAutocomplete.CS_BUTTON_PREFIX+this.sInputId;a.type="button";a.className="button";a.tabIndex=g.tabIndex+1;a.hAutocomplete=this;var m=document.createElement("INPUT");if(this.bAssociative){m.name=cAutocomplete.CS_INPUT_PREFIX+d}else{m.name=d}m.type="text";m.value=k;m.style.width=i-22;m.className=cAutocomplete.CS_INPUT_CLASSNAME;m.tabIndex=g.tabIndex;m.hAutocomplete=this;l.appendChild(m);l.appendChild(a);g.parentNode.replaceChild(l,g);m.id=this.sInputId;g=m}if(g.attachEvent){g.attachEvent("onkeyup",cAutocomplete.onInputKeyUp);g.attachEvent("onkeyup",cAutocomplete.saveCaretPosition);g.attachEvent("onkeydown",cAutocomplete.onInputKeyDown);g.attachEvent("onblur",cAutocomplete.onInputBlur);g.attachEvent("onfocus",cAutocomplete.onInputFocus);if(a){a.attachEvent("onclick",cAutocomplete.onButtonClick)}}else{if(g.addEventListener){g.addEventListener("keyup",cAutocomplete.onInputKeyUp,false);g.addEventListener("keyup",cAutocomplete.saveCaretPosition,false);g.addEventListener("keydown",cAutocomplete.onInputKeyDown,false);g.addEventListener("keypress",cAutocomplete.onInputKeyPress,false);g.addEventListener("blur",cAutocomplete.onInputBlur,false);g.addEventListener("focus",cAutocomplete.onInputFocus,false);if(a){a.addEventListener("click",cAutocomplete.onButtonClick,false)}}}g.setAttribute("autocomplete","OFF");if(e){if(e.attachEvent){e.attachEvent("onsubmit",cAutocomplete.onFormSubmit);if(this.bDebug){this.debug("attachEvent added")}}else{if(e.addEventListener){e.addEventListener("submit",cAutocomplete.onFormSubmit,false);if(this.bDebug){this.debug("addEventListener")}}}}};cAutocomplete.prototype.initListContainer=function(){var b=document.getElementById(this.sInputId);var e=document.createElement("DIV");e.className="autocomplete_holder";e.id=this.sListId;e.style.zIndex=10000+cAutocomplete.nCount;e.hAutocomplete=this;var d=document.createElement("DIV");d.className="autocomplete_firstborder";var c=document.createElement("DIV");c.className="autocomplete_secondborder";var a=document.createElement("UL");a.className="autocomplete";c.appendChild(a);d.appendChild(c);e.appendChild(d);document.body.appendChild(e);if(e.attachEvent){e.attachEvent("onblur",cAutocomplete.onListBlur);e.attachEvent("onfocus",cAutocomplete.onListFocus)}else{if(b.addEventListener){e.addEventListener("blur",cAutocomplete.onListBlur,false);e.addEventListener("focus",cAutocomplete.onListFocus,false)}}if(e.attachEvent){e.attachEvent("onclick",cAutocomplete.onItemClick)}else{if(e.addEventListener){e.addEventListener("click",cAutocomplete.onItemClick,false)}}};cAutocomplete.prototype.createList=function(){var f=document.getElementById(this.sInputId);var a=document.getElementById(this.sListId);var k=a.getElementsByTagName("UL")[0];if(k){k=k.parentNode.removeChild(k);while(k.hasChildNodes()){k.removeChild(k.childNodes[0])}}var j=null;var h=null;var e=null;var l=null;var d=this.aData;var g=0;var b;for(e in d){l=d[e];j=document.createElement("LI");h=document.createElement("A");h.setAttribute("itemvalue",e);var c=l.split(cAutocomplete.CS_ARRAY_SEPARATOR);if(c.length>1){this.aData[e]=c[0];h.setAttribute("itemdata",l.substring(l.indexOf(cAutocomplete.CS_ARRAY_SEPARATOR)+1));b=c[0]}else{b=l}h.href="#";h.appendChild(document.createTextNode(b));h.realText=b;if(g==this.nSelectedItemIdx){this.hActiveSelection=h;this.hActiveSelection.className="selected"}j.appendChild(h);k.appendChild(j);this.aSearchData[g++]=b.toLowerCase()}var i=a.firstChild.firstChild;i.appendChild(k);this.bListUpdated=false};cAutocomplete.prototype.initListArray=function(){var hInput=document.getElementById(this.sInputId);var hArr=null;if(hInput.type.toLowerCase()=="select-one"){hArr=new Object();for(var nI=0;nI<hInput.options.length;nI++){hArrKey=hInput.options.item(nI).value;sArrEl=hInput.options.item(nI).text;hArr[hArrKey]=sArrEl;if(hInput.options.item(nI).selected){this.nSelectedItemIdx=nI}}}else{var sAA=hInput.getAttribute("autocomplete_list");var sAAS=hInput.getAttribute("autocomplete_list_sort");var sArrayType=this.getListArrayType();switch(sArrayType){case"array":hArr=eval(sAA.substring(6));break;case"list":hArr=new Array();var hTmpArray=sAA.substring(5).split("|");var aValueArr;for(hKey in hTmpArray){aValueArr=hTmpArray[hKey].split(cAutocomplete.CS_ARRAY_SEPARATOR);if(aValueArr.length==1){hArr[hKey]=hTmpArray[hKey];this.bAssociative=false}else{hArr[aValueArr[0]]=aValueArr[1]}}break}if(sAAS!=null&&eval(sAAS)){this.bSorted=true;this.aData=hArr.sort();hArr=hArr.sort()}}this.setArray(hArr)};cAutocomplete.prototype.setArray=function(sArray){if(typeof sArray=="string"){this.aData=eval(sArray)}else{this.aData=sArray}this.bListUpdated=true};cAutocomplete.prototype.setListArray=function(a){this.setArray(a);this.updateAndShowList()};cAutocomplete.prototype.getListArrayType=function(){var b=document.getElementById(this.sInputId);var a=b.getAttribute("autocomplete_list");if(a!=null&&a.length>0){if(a.indexOf("array:")>=0){return"array"}else{if(a.indexOf("list:")>=0){return"list"}else{if(a.indexOf("url:")>=0){return"url"}else{if(a.indexOf("xmlrpc:")>=0){return"xmlrpc"}}}}}};cAutocomplete.prototype.getListURL=function(){var b=document.getElementById(this.sInputId);var a=b.getAttribute("autocomplete_list");if(a!=null&&a.length>0){if(a.indexOf("url:")>=0){return a.substring(4)}if(a.indexOf("xmlrpc:")>=0){return a.substring(7)}}};cAutocomplete.prototype.setListURL=function(a){this.sListURL=a};cAutocomplete.prototype.onXmlHttpLoad=function(){if(this.hXMLHttp.readyState==4){var a=this.hXMLHttp.parseError;if(a&&a.errorCode!=0){alert(a.reason)}else{this.afterRemoteLoad()}}};cAutocomplete.prototype.onXMLRPCHttpLoad=function(){if(this.hXMLHttp.readyState==4){var a=this.hXMLHttp.parseError;if(a&&a.errorCode!=0){alert(a.reason)}else{this.afterRemoteLoadXMLRPC()}}};cAutocomplete.prototype.loadXMLRPCListArray=function(){var f=this.sListURL;var i=data_path+"/RPC2.php";var h=f.split(" ");var g=h[0];var b=this.getStringForAutocompletion(this.sActiveValue,this.nInsertPoint);b=b.replace(/^\s/,"");b=b.replace(/\s$/,"");if(g.indexOf("?")>0){g=g.replace("/^.+?/","");f=f.replace("/?.+$/","")}else{f=i}if(g.length<1){var d=document.getElementById(this.sInputId);d.value=this.sActiveValue;return}var c="<?xml version='1.0' encoding=\"utf-8\" ?>\n";c+="<methodCall><methodName>"+g+"</methodName>\n";if(h.length<=1){c+="<params/>\n"}else{c+="<params>\n";for(var e=1;e<h.length;e++){var j=h[e];if(j.indexOf("[S]")>=0){j=j.replace("[S]",b)}c+="<param><value><string>";c+=j;c+="</string></value></param>\n"}c+="</params>\n"}c+="</methodCall>";if(this.bDebug){this.debug('url: "'+f+'" sRequest: "'+c.substring(20)+'"')}this.hXMLHttp.open("POST",f,true);var a=this;this.hXMLHttp.onreadystatechange=function(){a.onXMLRPCHttpLoad()};this.hXMLHttp.send(c)};cAutocomplete.prototype.loadListArray=function(){var b=this.sListURL;var a=this.getStringForAutocompletion(this.sActiveValue,this.nInsertPoint);a=a.replace(/^\s/,"");a=a.replace(/\s$/,"");if(b.indexOf("[S]")>=0){b=b.replace("[S]",a)}else{b+=this.sActiveValue}this.hXMLHttp.open("GET",b,true);var c=this;this.hXMLHttp.onreadystatechange=function(){c.onXmlHttpLoad()};this.hXMLHttp.send(null)};cAutocomplete.prototype.afterRemoteLoad=function(){var d=document.getElementById(this.sInputId);var c=new Array();var b=this.hXMLHttp.responseText.split("|");var a;for(hKey in b){a=b[hKey].split(cAutocomplete.CS_ARRAY_SEPARATOR);if(a.length==1){c[hKey]=b[hKey]}else{c[a[0]]=b[hKey].substr(b[hKey].indexOf(cAutocomplete.CS_ARRAY_SEPARATOR)+1)}}d.className="";d.readonly=false;d.value=this.sActiveValue;this.setListArray(c)};cAutocomplete.prototype.afterRemoteLoadXMLRPC=function(){var d=document.getElementById(this.sInputId);var b=new Array();sResult=this.hXMLHttp.responseText;if(this.bDebug){this.debug("response: "+sResult.substring(70,190))}sResult.replace("\n","");sResult.replace("\r","");var e=0;var c=sResult.indexOf("<string>");while(c>=0){var a;sResult=sResult.substring(c+8);a=sResult.indexOf("</string>");b[e]=sResult.substring(0,a);e+=1;sResult=sResult.substring(a+9);c=sResult.indexOf("<string>")}d.className="";d.readonly=false;d.value=this.sActiveValue;this.setListArray(b)};cAutocomplete.prototype.prepareList=function(a){var c=document.getElementById(this.sInputId);this.sActiveValue=c.value;var d=this.getStringForAutocompletion(this.sActiveValue,this.nInsertPoint);var b=this.getStringForAutocompletion(this.sLastActiveValue,this.nInsertPoint);if(b!=d||a||!this.bListDisplayed||this.bMatchSubstring){if(this.bRemoteList){c.className="search";this.bXMLRPC?this.loadXMLRPCListArray():this.loadListArray();return}this.updateAndShowList(a)}};cAutocomplete.prototype.updateAndShowList=function(a){var b=document.getElementById(this.sListId);var h=b.getElementsByTagName("UL")[0];var f=document.getElementById(this.sInputId);if(this.bListUpdated){this.createList()}var e=this.bMatchSubstring?this.getStringForAutocompletion(this.sActiveValue,this.nInsertPoint):this.sActiveValue;var i=this.bMatchSubstring?this.getStringForAutocompletion(this.sLastActiveValue,this.nInsertPoint):this.sLastActiveValue;if(e==i){if(!this.bMatchSubstring){a=true}}this.filterOptions(a);if(this.nItemsDisplayed==0){if(this.bForceCorrect){var g=this.getInsertPos(this.sActiveValue,this.nInsertPoint,"");cAutocomplete.markInputRange(f,this.nLastMatchLength,g[0])}}this.sLastActiveValue=this.sActiveValue;if(this.nItemsDisplayed>0){if(!a||this.bMatchSubstring){this.deselectOption()}if(this.bAutoComplete&&this.nItemsDisplayed==1){var c=this.getStringForAutocompletion(this.sActiveValue,this.nInsertPoint);var d=h.getElementsByTagName("LI")[this.nFirstDisplayed].getElementsByTagName("A")[0].realText;if(c.toLowerCase()==d.toLowerCase()){this.selectOption(h.getElementsByTagName("LI")[this.nFirstDisplayed].getElementsByTagName("A")[0]);this.hideOptions();return}}if(this.bAutoComplete&&!a){this.selectOption(h.getElementsByTagName("LI")[this.nFirstDisplayed].getElementsByTagName("A")[0])}this.showList()}else{this.clearList()}};cAutocomplete.prototype.showList=function(){if(cAutocomplete.hListDisplayed){cAutocomplete.hListDisplayed.clearList()}var e=document.getElementById(this.sInputId);var b=cDomObject.getOffsetParam(e,"offsetTop");var d=cDomObject.getOffsetParam(e,"offsetLeft");var f=document.getElementById(this.sListId);var a=f.getElementsByTagName("UL")[0];if(this.bHasButton){f.style.width=document.getElementById(this.sInputId).parentNode.offsetWidth}else{f.style.width=document.getElementById(this.sInputId).offsetWidth}var c=(this.nItemsDisplayed<cAutocomplete.CN_NUMBER_OF_LINES)?this.nItemsDisplayed:cAutocomplete.CN_NUMBER_OF_LINES;a.style.height=c*cAutocomplete.CN_LINE_HEIGHT+cAutocomplete.CN_HEIGHT_FIX+"px";f.style.top=b+e.offsetHeight+cAutocomplete.CN_OFFSET_TOP+"px";f.style.left=d+cAutocomplete.CN_OFFSET_LEFT+"px";f.style.display="none";f.style.visibility="visible";f.style.display="block";cAutocomplete.hListDisplayed=this;this.bListDisplayed=true};cAutocomplete.prototype.binarySearch=function(f){var a=0;var b=this.aSearchData.length-1;var c;var g,e;var h;var i=f.length;var d;while(a<=b){c=(a+b)/2;g=(c<1)?0:parseInt(c);h=this.aSearchData[g].substr(0,i);if(h<f){a=g+1;continue}if(h>f){b=g-1;continue}if(h==f){b=g-1;e=g;continue}return g}if(typeof(e)!="undefined"){return e}else{return null}};cAutocomplete.prototype.getStringForAutocompletion=function(e,c){if(e==null||e.length==0){return""}if(this.bMatchSubstring){var d=e.lastIndexOf(cAutocomplete.CS_SEPARATOR,c-1);d=d<0?0:d;var b=e.indexOf(cAutocomplete.CS_SEPARATOR,c);b=b<0?e.length:b;var a=e.substr(d,b-d);a=a.replace(/^(\,?)(\s*)(\S*)(\s*)(\,?)$/g,"$3");return a}else{return e}};cAutocomplete.prototype.insertString=function(f,d,a){if(this.bMatchSubstring){var e=f.lastIndexOf(cAutocomplete.CS_SEPARATOR,d-1);e=e<0?0:e;var c=f.indexOf(cAutocomplete.CS_SEPARATOR,d);c=c<0?f.length:c;var b=f.substr(e,c-e);b=b.replace(/^(\,?)(\s*)(\S?[\S\s]*\S?)(\s*)(\,?)$/g,"$1$2"+a+"$4$5");b=f.substr(0,e)+b+f.substr(c);return b}else{return a}};cAutocomplete.prototype.getInsertPos=function(f,d,a){d=d==null?0:d;var e=f.lastIndexOf(cAutocomplete.CS_SEPARATOR,d-1);e=e<0?0:e;var c=f.indexOf(cAutocomplete.CS_SEPARATOR,d);c=c<0?f.length:c;var b=f.substr(e,c-e);b=b.replace(/^(\,?)(\s*)(\S?[\S\s]*\S?)(\s*)(\,?)$/g,"$1$2"+a);return[d,e+b.length]};cAutocomplete.prototype.filterOptions=function(j){if(this.hActiveSelection&&!j){this.hActiveSelection.className=""}if(typeof j=="undefined"){j=false}var g=document.getElementById(this.sInputId);var c=this.getStringForAutocompletion(this.sActiveValue,this.nInsertPoint);if(j){c=""}var b=document.getElementById(this.sListId);var n=b.getElementsByTagName("UL")[0];var k=n.childNodes.length;var d=null;var a=0;var h=n.parentNode;var n=n.parentNode.removeChild(n);var l=n.childNodes;this.nItemsDisplayed=0;if(c.length==0){for(var i=0;i<k;i++){if(this.formatOptions){l[i].childNodes[0].innerHTML=this.formatOptions(l[i].childNodes[0].realText,i)}l[i].style.display="block"}a=k;if(k>0){this.nFirstDisplayed=0;this.nLastDisplayed=k-1}else{this.nFirstDisplayed=this.nLastDisplayed=-1}var f=this.getInsertPos(this.sActiveValue,this.nInsertPoint,c);this.nLastMatchLength=f[0]}else{this.nFirstDisplayed=this.nLastDisplayed=-1;c=c.toLowerCase();var m=false;if(this.bSorted&&this.bMatchBegin){var e=this.binarySearch(c);for(var i=0;i<k;i++){l[i].style.display="none";if(i>=e&&!m){if(!m&&this.aSearchData[i].indexOf(c)!=0){m=true;continue}if(this.formatOptions){l[i].childNodes[0].innerHTML=this.formatOptions(l[i].childNodes[0].realText,i)}l[i].style.display="block";a++;if(this.nFirstDisplayed<0){this.nFirstDisplayed=i}this.nLastDisplayed=i}}}else{for(var i=0;i<k;i++){l[i].style.display="none";if((this.bMatchBegin&&this.aSearchData[i].indexOf(c)==0)||(!this.bMatchBegin&&this.aSearchData[i].indexOf(c)>=0)){if(this.formatOptions){l[i].childNodes[0].innerHTML=this.formatOptions(l[i].childNodes[0].realText,i)}l[i].style.display="block";a++;if(this.nFirstDisplayed<0){this.nFirstDisplayed=i}this.nLastDisplayed=i}}}if(a>0){var f=this.getInsertPos(this.sActiveValue,this.nInsertPoint,c);this.nLastMatchLength=f[0]}}h.appendChild(n);this.nItemsDisplayed=a};cAutocomplete.prototype.hideOptions=function(){var a=document.getElementById(this.sListId);a.style.visibility="hidden";a.style.display="none";this.hListDisplayed=null};cAutocomplete.prototype.markAutocompletedValue=function(){var c=document.getElementById(this.sInputId);var e=this.hActiveSelection.realText;if(this.bMatchSubstring){var a=this.getInsertPos(this.sLastActiveValue,this.nInsertPoint,e);var d=a[0];var b=a[1]}else{var d=this.nInsertPoint;var b=e.length}this.nStartAC=d;this.nEndAC=b;if(this.hMarkRangeTimeout!=null){clearTimeout(this.hMarkRangeTimeout)}this.hMarkRangeTimeout=setTimeout(function(){cAutocomplete.markInputRange2(c.id)},cAutocomplete.CN_MARK_TIMEOUT)};cAutocomplete.prototype.selectOptionByIndex=function(b){if(this.bListUpdated){this.createList()}var d=document.getElementById(this.sListId);var a=d.getElementsByTagName("UL")[0];var c=a.childNodes.length;if(b>=0&&b<c){this.selectOption(a.childNodes[b].getElementsByTagName("A")[0])}};cAutocomplete.prototype.selectOptionByValue=function(f){if(this.bListUpdated){this.createList()}f=f.toLowerCase();var e=document.getElementById(this.sListId);var a=e.getElementsByTagName("UL")[0];var c=a.childNodes.length;var d=-1;for(var b=0;b<c;b++){if(this.aSearchData[b].indexOf(f)==0){d=b}}if(d>=0){this.selectOption(a.childNodes[d].getElementsByTagName("A")[0])}};cAutocomplete.prototype.selectOption=function(b){if(this.hActiveSelection){if(this.hActiveSelection==b){return}else{this.hActiveSelection.className=""}}this.hActiveSelection=b;var c=document.getElementById(this.sInputId);if(this.hActiveSelection!=null){if(this.sHiddenInputId!=null){if(this.bMatchSubstring){document.getElementById(this.sHiddenInputId).value=this.hActiveSelection.getAttribute("itemvalue")}else{document.getElementById(this.sHiddenInputId).value=this.hActiveSelection.getAttribute("itemvalue")}}this.hActiveSelection.className="selected";if(this.bAutoComplete){c.value=this.insertString(this.sLastActiveValue,this.nInsertPoint,this.hActiveSelection.realText);this.bAutocompleted=true;this.markAutocompletedValue()}else{var a=this.getInsertPos(this.sLastActiveValue,this.nInsertPoint,this.hActiveSelection.realText);c.value=this.insertString(this.sActiveValue,this.nInsertPoint,this.hActiveSelection.realText);cAutocomplete.setInputCaretPosition(c,a[1])}this.sActiveValue=c.value;if(this.onSelect){this.onSelect()}}else{c.value=this.sActiveValue;cAutocomplete.setInputCaretPosition(c,this.nInsertPoint)}};cAutocomplete.prototype.deselectOption=function(){if(this.hActiveSelection!=null){this.hActiveSelection.className="";this.hActiveSelection=null}};cAutocomplete.prototype.clearList=function(){this.hideOptions();this.bListDisplayed=false};cAutocomplete.prototype.getPrevDisplayedItem=function(a){if(a==null){var b=document.getElementById(this.sListId);a=b.getElementsByTagName("UL")[0].childNodes.item(b.getElementsByTagName("UL")[0].childNodes.length-1)}else{a=getPrevNodeSibling(a.parentNode)}while(a!=null){if(a.style.display=="block"){return a}a=a.previousSibling}return null};cAutocomplete.prototype.getNextDisplayedItem=function(a){if(a==null){var b=document.getElementById(this.sListId);a=b.getElementsByTagName("UL")[0].childNodes.item(0)}else{a=getNextNodeSibling(a.parentNode)}while(a!=null){if(a.style.display=="block"){return a}a=a.nextSibling}return null};cAutocomplete.prototype.debug=function(b){if(this.bDebug){var a=document.getElementById(this.sInputId);var c=document.createElement("DIV");c.className="debug";c.innerHTML=b;a.form.appendChild(c)}};cAutocomplete.onInputKeyDown=function(g){if(g==null){g=window.event}var d=(g.srcElement)?g.srcElement:g.originalTarget;var a=d.hAutocomplete;var b=document.getElementById(a.sListId);var f=document.getElementById(a.sInputId);var i=b.getElementsByTagName("UL")[0];var h=getParentByTagName(d,"A");if(b!=null&&a.bListDisplayed){var j=null;var c=null;if((g.keyCode==13)||(g.keyCode==27)){var e=g.keyCode==13?true:false;a.clearList();if(a.bDebug){a.debug("key "+g.keyCode+" new active selection")}}if(g.keyCode==38){if(a.bDebug){a.debug("key "+g.keyCode+" up")}c=a.getPrevDisplayedItem(a.hActiveSelection);if(c!=null){a.selectOption(c.childNodes.item(0));if(a.nItemsDisplayed>cAutocomplete.CN_NUMBER_OF_LINES){if(i.scrollTop<5&&c.offsetTop>i.offsetHeight){i.scrollTop=i.scrollHeight-i.offsetHeight}if(c.offsetTop-i.scrollTop<0){i.scrollTop-=c.offsetHeight}}}else{a.selectOption(null)}}else{if(g.keyCode==40){if(a.bDebug){a.debug("key "+g.keyCode+" down")}c=a.getNextDisplayedItem(a.hActiveSelection);if(c!=null){a.selectOption(c.childNodes.item(0));if(a.nItemsDisplayed>cAutocomplete.CN_NUMBER_OF_LINES){if(i.scrollTop>0&&i.scrollTop>c.offsetTop){i.scrollTop=0}if(Math.abs(c.offsetTop-i.scrollTop-i.offsetHeight)<5){i.scrollTop+=c.offsetHeight}}}else{a.selectOption(null)}}}}if(f.form){f.form.bLocked=true;if(a.bDebug){a.debug("onInputKeyDown form blocked")}}if(g.keyCode==13||g.keyCode==27||g.keyCode==38||g.keyCode==40){if(g.preventDefault){g.preventDefault()}else{if(a.bDebug){a.debug("no preventDefault return false")}}g.cancelBubble=true;g.returnValue=false;return false}};cAutocomplete.onInputKeyPress=function(a){if(a.keyCode==13||a.keyCode==38||a.keyCode==40){if(a.preventDefault){a.preventDefault()}a.cancelBubble=true;a.returnValue=false;return false}};cAutocomplete.onInputKeyUp=function(e){if(e==null){e=window.event}var b=(e.srcElement)?e.srcElement:e.originalTarget;var d=b.hAutocomplete;var a=document.getElementById(d.sInputId);switch(e.keyCode){case 8:if(d.bAutoComplete&&d.bAutocompleted){d.bAutocompleted=false;return false}break;case 38:case 40:if(d.bListDisplayed){if(e.preventDefault){e.preventDefault()}e.cancelBubble=true;e.returnValue=false;return false}break;case 32:case 46:case 35:case 36:break;default:if(e.keyCode<48){if(e.preventDefault){e.preventDefault()}if(d.bDebug){d.debug("keyUp: hEvent.returnValue = false")}e.cancelBubble=true;e.returnValue=false;return false}break}if(d.hMarkRangeTimeout!=null){clearTimeout(d.hMarkRangeTimeout)}if(d.hShowTimeout){clearTimeout(d.hShowTimeout);d.hShowTimeout=null}var c=d.bRemoteList?cAutocomplete.CN_REMOTE_SHOW_TIMEOUT:cAutocomplete.CN_SHOW_TIMEOUT;d.hShowTimeout=setTimeout(function(){d.prepareList()},c);if(d.bDebug){d.debug("setTimeout "+c)}};cAutocomplete.onInputBlur=function(c){if(c==null){c=window.event}var a=(c.srcElement)?c.srcElement:c.originalTarget;if(a.form){a.form.bLocked=false}var b=a.hAutocomplete;if(!b.hClearTimeout){b.hClearTimeout=setTimeout(function(){b.clearList()},cAutocomplete.CN_CLEAR_TIMEOUT)}};cAutocomplete.onInputFocus=function(c){if(c==null){c=window.event}var a=(c.srcElement)?c.srcElement:c.originalTarget;var b=a.hAutocomplete;if(b.hClearTimeout){clearTimeout(b.hClearTimeout);b.hClearTimeout=null}};cAutocomplete.saveCaretPosition=function(d){if(d==null){d=window.event}var b=(d.srcElement)?d.srcElement:d.originalTarget;var c=b.hAutocomplete;var a=document.getElementById(c.sInputId);if(d.keyCode!=38&&d.keyCode!=40){c.nInsertPoint=cAutocomplete.getInputCaretPosition(a)}};cAutocomplete.getInputCaretPosition=function(c){if(typeof c.selectionStart!="undefined"){if(c.selectionStart==c.selectionEnd){return c.selectionStart}else{return c.selectionStart}}else{if(c.createTextRange){var e=document.selection.createRange();if(c.tagName.toLowerCase()=="textarea"){var a=e.duplicate();var b=e.duplicate();e.moveToElementText(c);a.setEndPoint("StartToStart",e);return a.text.length}else{e.moveStart("character",-1*c.value.length);var d=e.text.length;return d}}}return null};cAutocomplete.setInputCaretPosition=function(c,a){if(c.setSelectionRange){c.setSelectionRange(a,a)}else{if(c.createTextRange){var b=c.createTextRange();b.moveStart("character",a);b.moveEnd("character",a);b.collapse(true);b.select()}}};cAutocomplete.markInputRange=function(c,d,a){if(c.setSelectionRange){c.focus();c.setSelectionRange(d,a)}else{if(c.createTextRange){var b=c.createTextRange();b.collapse(true);b.moveStart("character",d);b.moveEnd("character",a-d);b.select()}}};cAutocomplete.markInputRange2=function(a){var c=document.getElementById(a);var d=c.hAutocomplete.nStartAC;var b=c.hAutocomplete.nEndAC;cAutocomplete.markInputRange(c,d,b)};cAutocomplete.onListBlur=function(c){if(c==null){c=window.event}var a=(c.srcElement)?c.srcElement:c.originalTarget;a=getParentByProperty(a,"className","autocomplete_holder");var b=a.hAutocomplete;if(!b.hClearTimeout){b.hClearTimeout=setTimeout(function(){b.clearList()},cAutocomplete.CN_CLEAR_TIMEOUT)}};cAutocomplete.onListFocus=function(c){if(c==null){c=window.event}var a=(c.srcElement)?c.srcElement:c.originalTarget;a=getParentByProperty(a,"className","autocomplete_holder");var b=a.hAutocomplete;if(b.hClearTimeout){clearTimeout(b.hClearTimeout);b.hClearTimeout=null}};cAutocomplete.onItemClick=function(d){if(d==null){d=window.event}var a=(d.srcElement)?d.srcElement:d.originalTarget;var e=getParentByProperty(a,"className","autocomplete_holder");var c=getParentByTagName(a,"A");if(e!=null){var b=e.hAutocomplete;b.selectOption(c);document.getElementById(b.sInputId).focus();b.clearList()}if(d.preventDefault){d.preventDefault()}d.cancelBubble=true;d.returnValue=false;return false};cAutocomplete.onButtonClick=function(d){if(d==null){d=window.event}var b=(d.srcElement)?d.srcElement:d.originalTarget;var c=b.hAutocomplete;var a=document.getElementById(c.sInputId);if(a.disabled){return}if(c.bDebug){c.debug("onButtonClick")}c.prepareList(true);var a=document.getElementById(c.sInputId);a.focus()};cAutocomplete.onFormSubmit=function(c){if(c==null){c=window.event}var a=(c.srcElement)?c.srcElement:c.originalTarget;if(a.bLocked){var b=a.hAutocomplete;if(b.bDebug){b.debug("onSubmit: hElement.bLocked")}a.bLocked=false;c.returnValue=false;if(c.preventDefault){c.preventDefault()}return false}};