<?php
//
// SourceForge: Breaking Down the Barriers to Open Source Development
// Copyright 1999-2000 (c) The SourceForge Crew
// http://sourceforge.net
//


/*
	Tim Perdue, September 7, 2000


	Base class for adding multilingual support to SF.net

	Contains variables which can be overridden optionally by other
	language files.

	Base language is english - an english class will extend this one,
	but won't override anything

	As new languages are added, they can override what they wish, and 
		as we extend our class, other languages can follow suit
		as they are translated without holding up our progress

	Soon-Son Kwon, June 11, 2002
	

	Added more strings
*/

class BaseLanguage {

	function BaseLanguage() {

	}
	//result set handle for supported langauges
	var $language_res;

	//what content encoding scheme are we using?
	var $content_encoding='iso-8859-1';

	//english has an ID of 1 in the database
	var $language_id=1;

	//two letter language code
	var $language_code='en';

	//default font which can be overridden on a language-by-language basis
	var $default_font='verdana,arial,helvetica,sans-serif';

	//navigation menu strings
	var $SEARCH='Search';
	var $LOGOUT='Logout';
	var $LOGIN='Login via SSL';
	var $NEW_USER='New User via SSL';
	var $NEW_PROJECT='Register New Project';
	var $ACCOUNT_MAINTENANCE='Account Maintenance';
	var $DIARY='Diary & Notes';
	var $CHANGE_MY_THEME='Change My Theme';
	var $MY_PERSONAL_PAGE='My Personal Page';
	var $BOOKMARK_PAGE='Bookmark Page';
	var $PROJECT_SUMMARY='Project Summary';
	var $PROJECT_ADMIN='Project Admin';
	var $FOUNDRY_SUMMARY='Foundry Summary';
	var $FOUNDRY_ADMIN='Foundry Admin';
	var $SOFTWARE_MAP='Software Map';
	var $NEW_RELEASES='New Releases';
	var $OTHER_SITE_MIRRORS='Other Site Mirrors';
	var $CODE_SNIPPET_LIBRARY='Code Snippet Library';
	var $DOCUMENTATION='Site Docs';
	var $DISCUSSION_FORUMS='Discussion Forums';
	var $PROJECT_HELP_WANTED='Project Help Wanted';
	var $TOP_PROJECTS='Top Projects';
	var $COMPILE_FARM='Compile Farm';
	var $CONTACT_US='Contact SourceForge';

        // 2000-11-24
 	var $ABOUT_SOURCEFORGE='About SourceForge';
 	var $ABOUT_FOUNDRIES='About Foundries';

	//tool short names as in HTML_TABS()
	var $GROUP_SHORT_MAIN ='Main';
	var $GROUP_SHORT_SUMMARY='Summary';
	var $GROUP_SHORT_HOMEPAGE='Home Page';
	var $GROUP_SHORT_FORUM='Forums';
	var $GROUP_SHORT_BUGS='Bugs';
	var $GROUP_SHORT_SUPPORT='Support';
	var $GROUP_SHORT_PATCH='Patches';
	var $GROUP_SHORT_MAIL='Lists';
	var $GROUP_SHORT_PM='Tasks';
	var $GROUP_SHORT_DOCMAN='Docs';
	var $GROUP_SHORT_SURVEY='Surveys';
	var $GROUP_SHORT_NEWS='News';
	var $GROUP_SHORT_CVS='CVS';
	var $GROUP_SHORT_FILES='Files';
        // 2000-11-24
	var $GROUP_SHORT_MEMBERLIST='Developers';

	//tool long names for summary page
	var $LATEST_FILE_RELEASES='Latest File Releases';
	var $FILE_PACKAGE='Package';
	var $FILE_VERSION='Version';
	var $FILE_REL_DATE='Date';
	var $FILE_MONITOR='Monitor';
	var $FILE_NOTES='Notes';
	var $FILE_DOWNLOAD='Download';

	var $DEVELOPER_INFO='Developer Info';
	var $PROJECT_ADMINS='Project Admins';
	var $DEVELOPERS='Developers';
	var $PUBLIC_AREA='Public Areas';

	var $GROUP_LONG_HOMEPAGE='Project Home Page';
	var $GROUP_LONG_FORUM='Public Forums';
	var $GROUP_LONG_BUGS='Bug Tracking';
	var $GROUP_LONG_SUPPORT='Tech Support Manager';
	var $GROUP_LONG_PATCH='Patch Manager';
	var $GROUP_LONG_MAIL='Mailing Lists';
	var $GROUP_LONG_PM='Task Manager';
	var $GROUP_LONG_DOCMAN='DocManager: Project Documentation';
	var $GROUP_LONG_SURVEY='Surveys';
	var $GROUP_LONG_NEWS='Latest News';	
	var $GROUP_LONG_CVS='CVS Repository';
	var $GROUP_LONG_FTP='Anonymous FTP Space';
	var $GROUP_LONG_FOUNDRIES='SourceForge Development Foundries';


	//
	// New strings for home page added 10/1
	//
	var $BREAKING_DOWN_BARRIERS='Breaking Down the Barriers to Open Source Development';
	var $SOURCEFORGE_STATISTICS='SourceForge Statistics';
	var $TOP_PROJECT_DOWNLOADS='Top Project Downloads';
	var $HIGHEST_RANKED_USERS='Highest Ranked Users';
	var $MOST_ACTIVE_THIS_WEEK='Most Active This Week';
	var $SFOS='SourceForge OnSite';


//temporary hack until
//content manager is ready

	var $HOME_PAGE_ABOUT_BLURB='

SourceForge is a <B>free service to
<A href="http://www.opensource.org">Open Source</A> developers</B> offering
easy access to the best in CVS, mailing lists, bug tracking, message boards/forums,
task management, site hosting, permanent file archival, full backups,
and total web-based administration. 
<BR>
&nbsp;
<P>
<B>Site Feedback and Participation</B>
<P>
In order to get the most out of SourceForge, you\'ll need
to <A href="/account/register.php">register as a
site user</A>. This will allow you to participate fully in all we have to
offer. You may of course browse the site without registering, but will
not have access to participate fully.
<P>
&nbsp;
<BR>
<B>Set Up Your Own Project</B>
<P>
<A href="/account/register.php">Register as a site user</A>,
then <A HREF="/account/login.php">Login</A> and finally,
<A HREF="/register/">Register Your Project.</A>
Thanks... and enjoy the site.';

	// New strings added on 2002/06/10 by Soon-Son Kwon
	var $FOOTER='
<font face="arial, helvetica" size="1" color="#cccccc">
VA Linux Systems and SourceForge are trademarks of VA Linux Systems, Inc.
Linux is a registered trademark of Linus Torvalds.  All other trademarks and
copyrights on this page are property of their respective owners.
For information about other site Content ownership and sitewide
terms of service, please see the
<a href="/tos/tos.php" class="legallink">SourceForge Terms of Service</a>.
For privacy
policy information, please see the <a href="/tos/privacy.php" class="legallink"
>SourceForge Privacy Policy</a>.
Content owned by VA Linux Systems is copyright
1999-2000 VA Linux Systems, Inc.  All rights reserved.
</font>';

	var $IEWARN='<H2><FONT COLOR="RED">Internet Explorer users need to upgrade to IE 5.01 or higher, preferably with 128-bit SSL or use Netscape 4.7 or higher</FONT></H2>';
	var $MACWARN='<H2><FONT COLOR="RED">Internet Explorer on the Macintosh is not supported currently. Use Netscape 4.7 or higher</FONT></H2>';
	var $ACCOUNTLOGIN='SourceForge Site Login';
	var $COOKIEWARN='Cookies must be enabled past this point.';
	var $USESSL='Stay in SSL mode after login';
	var $SSLNOTICE='<p><B><FONT COLOR="RED">You will be connected with an SSL server when you submit this form and your password will not be visible to other users.</FONT></B> <small style="font-size: x-small"> (If you wonder why very this page is not loaded via SSL, please read next paragraph. Thank you.) </small> <P> <B>Internet Explorer</B> users will have intermittent SSL problems, so they should leave SSL after login. Netscape users should stay in SSL mode permanently for maximum security.  Visit <A HREF="http://www.microsoft.com/">Microsoft</A> for more information about this known problem.  <P>';

	// New strings added on 2002/06/11 by Soon-Son Kwon
	var $FIRSTBLURB='
<B><P>Welcome!</P></B>
<P>You are now a registered user on Sourceforge, the online development environment for Open Source projects.
<P>As a registered user, you can participate fully in the activities on the site. You may now post messages to the project message forums, post bugs for software in Sourceforge, sign on as a project developer, or even start your own project.
<P>You should take some time to read through the <A href="/docs/site/"><b>Site Documentation</b></A> so that you may take full advantage of Sourceforge.
<P>Enjoy the site, and please provide us with feedback on ways that we can improve Sourceforge.
<P>--the Sourceforge staff';

	var $ANONCVS='<P><B>Anonymous CVS Access</B> <P>This project\'s CVS repository can be checked out through anonymous (pserver) CVS with the following instruction set. The module you wish to check out must be specified as the <I>modulename</I>. When prompted for a password for <I>anonymous</I>, simply press the Enter key.';
	var $ANONCVSUP='Updates from within the module\'s directory do not need the -d parameter.';
	var $DEVCVS='<P><B>Developer CVS Access via SSH</B> <P>Only project developers can access the CVS tree via this method. SSH1 must be installed on your client machine. Substitute <I>modulename</I> and <I>developername</I> with the proper values. Enter your site password when prompted.';
	var $CVSHISTORY='Repository History';
	var $BROWSETREE='<HR><B>Browse the CVS Tree</B> <P>Browsing the CVS tree gives you a great view into the current status of this project\'s code. You may also view the complete histories of any file in the repository.';
	var $BROWSEIT='Browse CVS Repository';

	var $ACCOUNTREGISTER_title='New Account Registration';
	var $ACCOUNTREGISTER_congrat='<p>Congratulations. You have registered on SourceForge.  <p> You are now being sent a confirmation email to verify your email address. Visiting the link sent to you in this email will activate your account.';
	var $ACCOUNTREGISTER_loginname='Login Name (do not use uppercase letters) *:';
	var $ACCOUNTREGISTER_password='Password (min. 6 chars) *:';
	var $ACCOUNTREGISTER_password2='Password (repeat) *:';
	var $ACCOUNTREGISTER_realname='Full/Real Name *:';
	var $ACCOUNTREGISTER_language='Language Choice:';
	var $ACCOUNTREGISTER_timezone='Timezone:';
	var $ACCOUNTREGISTER_emailaddr='Email Address *: <BR><I>This email address will be verified before account activation. It will not be displayed on the site. You will receive a mail forward account at &lt;loginname@users.';
	var $ACCOUNTREGISTER_emailaddr2='&gt; that will forward to this address.</I>';
	var $ACCOUNTREGISTER_siteupdate='Receive Email about Site Updates <I>(Very low traffic and includes security notices. Highly Recommended.)</I>';
	var $ACCOUNTREGISTER_communitymail='Receive additional community mailings. <I>(Low traffic.)</I>';
	var $ACCOUNTREGISTER_register='Register';


	/*
		returns database result
		of supported languages
	*/
	function getLanguages() {
		if (!$this->language_res) { 
			$this->language_res=db_query("SELECT * FROM supported_languages ORDER BY name ASC");
		}
		return $this->language_res;
	}

	function getLanguageId() {
		return $this->language_id;
	}

	function getLanguageName($id=false) {
		if (!$id) {
			$id=$this->getLanguageId();
		}
		return db_result(db_query("SELECT name FROM supported_languages WHERE language_id='$id'"),0,0);
	}

	function getEncoding() {
		return $this->content_encoding;
	}

	function getFont() {
		return $this->default_font;
	}

	function getLanguageCode() {
		return $this->language_code;
	}
}


function language_code_to_result($alang) {
	global $cookie_language_id;

	/*


		Determine which language file to use

		It depends on whether the user has set a cookie or not using
		the account page or the left-hand nav or how their browser is 
		set or whether they are logged in or not

		if logged in, use language from users table
		else check for cookie and use that value if valid
		if no cookie check browser preference and use that language if valid
		else just use english

	*/

	if ($cookie_language_id) {
		$lang=$cookie_language_id;
		$res=db_query("select * from supported_languages where language_id='$lang'");
		if (!$res || db_numrows($res) < 1) {
			return db_query("select * from supported_languages where language_id='1'"); // default to english
		} else {
			return $res;
		}
	} else {
		$ary = explode(',', str_replace(' ', '', $alang)); // delete space and split
		for( $i=0; $i<sizeof($ary); $i++){
			$lang_code = ereg_replace(';.*', '', $ary[$i]); // remove ;q=0.x
			$res = db_query("select * from supported_languages where language_code = '$lang_code'");
			if (db_numrows($res) > 0) {
				return $res;
			}
		}
		return db_query("select * from supported_languages where language_id='1'"); // default to english
	}
}

?>
