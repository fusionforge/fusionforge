<?php
/**
  *
  * SourceForge Sitewide Statistics - stats common module
  *
  * SourceForge: Breaking Down the Barriers to Open Source Development
  * Copyright 1999-2001 (c) VA Linux Systems
  * http://sourceforge.net
  *
  * @version   $Id: change_email.php,v 1.12 2001/05/13 17:53:29 pfalcon Exp $
  *
  */


require_once('pre.php');
require_once('graph_lib.php');

if ( ! $group_id ) {
	$group_id = 0;
}

if ( ! $year ) {
	$year = gmstrftime("%Y", time() );
}

$sql	= "SELECT month,week,day,SUM(site_views) AS site_views, SUM(subdomain_views) AS subdomain_views "
	. "FROM stats_site GROUP BY month,week,day ORDER BY month ASC, week ASC";
$res = db_query( $sql,52 );

$i = 0;
while ( $row = db_fetch_array($res) ) {
        $xdata[$i]          = $i;
	$xlabel[$i]         = "Week " . $row["week"] . " of " . substr($row['month'],0,4);
        $ydata1[$i]         = $row["site_views"] + $row["subdomain_views"];
        ++$i;
}

$graph = new Graph( 750, 550 );

$data1 = $graph->AddData( $xdata, $ydata1, $xlabel );

$graph->DrawGrid('gray');
$graph->LineGraph($data1,'red');
$graph->SetTitle('Sourceforge Page Views');
$graph->SetSubTitle("Page Views (RED) since beginning of time ( $i days )");
$graph->SetxTitle('Date');
$graph->SetyTitle('Views (RED)');
$graph->DrawAxis();
//$graph->showDebug();
$graph->ShowGraph('gif');

?>
