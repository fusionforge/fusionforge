r2674 tags/Branch_3_1-merge_6