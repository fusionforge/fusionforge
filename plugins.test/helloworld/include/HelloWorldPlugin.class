<?php

class HelloWorldPlugin extends Plugin {
	function HelloWorldPlugin () {
		$this->Plugin() ;
		$this->name = "helloworld" ;
		$this->text = "Hello World!" ; // To show in the tabs, use...
		$this->hooks[] = "usermenu" ;
		$this->hooks[] = "groupmenu" ;	// To put into the project tabs
		$this->hooks[] = "groupisactivecheckbox" ; // The "use ..." checkbox in editgroupinfo
		$this->hooks[] = "groupisactivecheckboxpost" ; // 
	}

	function CallHook ($hookname, $params) {
		global $use_helloworldplugin,$G_SESSION,$HTML;
		$group_id=$params['group'];
		if ($hookname == "usermenu") {
			$text = $this->text;
			if ($G_SESSION->usesPlugin("helloworld")) {
				$text .= ' [on]' ;
			} else {
				$text .= ' [off]' ;
			}
			echo ' | ' . $HTML->PrintSubMenu (array ($text),
						  array ('/plugins/helloworld/index.php?user_id=' . $G_SESSION->getId()));
		} elseif ($hookname == "groupmenu") {
			$project = &group_get_object($group_id);
			if (!$project || !is_object($project))
				return;
			if ($project->isError())
				return;
			if (!$project->isProject())
				return;
			$params['DIRS'][]='/plugins/helloworld/group.php?group_id=' . $group_id;
			if ( $project->usesPlugin ( $this->name ) ) {
				$params['TITLES'][]=$this->text;
			} else {
				$params['TITLES'][]=$this->text." [Off]";
	
			}
							
			(($params['toptab'] == $this->name) ? $params['selected']=(count($params['TITLES'])-1) : '' );
		} elseif ($hookname == "groupisactivecheckbox") {
                        //Check if the group is active
			$group = &group_get_object($group_id);
			echo "<tr>";
			echo "<td>";
			echo ' <input type="CHECKBOX" name="use_helloworldplugin" value="1" ';
	// CHECKED OR UNCHECKED?
	if ( $group->usesPlugin ( $this->name ) ) {
				echo "CHECKED";
                            }
			echo "><br/>";
			echo "</td>";
			echo "<td>";
			echo "<strong>Use ".$this->text." Plugin</strong>";
			echo "</td>";
			echo "</tr>";
		} elseif ($hookname == "groupisactivecheckboxpost") {
		        $group = &group_get_object($group_id);
			if ( $use_helloworldplugin == 1 ) {
				$group->setPluginUse ( $this->name );
			} else {
				$group->setPluginUse ( $this->name, false );
			}
		}													    
		elseif ($hookname == "blahblahblah") {
			// ...
		} 
	}
}

// Local Variables:
// mode: php
// c-file-style: "bsd"
// End:

?>
