var doctype='<?xml version="1.0" encoding="utf-8"?>\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">';var cssfile='<link rel="stylesheet" type="text/css" href="'+data_path+'/themes/default/toolbar.css" />';if(window.top!=window){window.top.location=window.location}var pullwin;function addButton(e,a,d,b){var c;a=escapeQuotes(a);document.write('<a href="javascript:'+d+"(");for(c=0;c<b.length;c++){if(c>0){document.write(",")}document.write("'"+escapeQuotes(b[c])+"'")}document.write(');"><img src="'+e+'" width="18" height="18" border="0" alt="'+a+'" title="'+a+'">');document.write("</a>");return}function addTagButton(e,a,c,b,d){addButton(e,a,"insertTags",[c,b,d]);return}function showPulldown(j,c,g,a,d){var l=new String(Math.min(315,80+(c.length*12)));var b=500;var e=(screen.height-l)/2;var k=(screen.width-b)/2;pullwin=window.open("","","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=yes,copyhistory=no,top="+e+",left="+k+",height="+l+",width="+b);pullwin.window.document.writeln(doctype);pullwin.window.document.writeln("<html>\n<head>\n<title>"+escapeQuotes(j)+"</title>");pullwin.window.document.writeln(cssfile);pullwin.window.document.writeln("</head>\n<body>");pullwin.window.document.writeln("<p>\nYou can double-click to insert.\n</p>");pullwin.window.document.writeln('<form action=""><div id="buttons"><input type="button" value="'+g+'" onclick="if(self.opener)self.opener.do_pulldown(document.forms[0].select.value,\''+d+'\'); return false;" /><input type="button" value="'+a+'" onclick="self.close(); return false;" /></div>\n<div>\n<select style="margin-top:10px;width:190px;" name="select" size="'+((c.length>20)?"20":new String(c.length))+'" ondblclick="if(self.opener)self.opener.do_pulldown(document.forms[0].select.value,\''+d+"'); return false;\">");for(i=0;i<c.length;i++){if(typeof c[i]=="string"){pullwin.window.document.write('<option value="'+c[i]+'">'+escapeQuotes(c[i])+"</option>\n")}else{pullwin.window.document.write('<option value="'+c[i][1]+'">'+escapeQuotes(c[i][0])+"</option>\n")}}pullwin.window.document.writeln("</select>\n</div>\n</form>\n</body>\n</html>");pullwin.window.document.close();return false}function do_pulldown(b,a){if(a=="tb-categories"){var c=document.getElementById("edit-content");b=unescapeSpecial(b);c.value+="\n"+b}else{insertTags(b,"","\n")}return}function addInfobox(c){var b=navigator.userAgent.toLowerCase();var a=((b.indexOf("gecko")!=-1)&&(b.indexOf("spoofer")==-1)&&(b.indexOf("khtml")==-1));if(!document.selection&&!a){c=escapeQuotesHTML(c);document.write("<form name='infoform' id='infoform'><input size=80 id='infobox' name='infobox' value=\""+c+'" readonly="readonly"></form>')}}function escapeQuotes(b){var a=new RegExp("'","g");b=b.replace(a,"\\'");a=new RegExp('"',"g");b=b.replace(a,"&quot;");a=new RegExp("\\n","g");b=b.replace(a,"\\n");return b}function escapeQuotesHTML(b){var a=new RegExp('"',"g");b=b.replace(a,"&quot;");return b}function unescapeSpecial(b){var a=new RegExp("%0A","g");b=b.replace(a,"\n");var a=new RegExp("%22","g");b=b.replace(a,'"');var a=new RegExp("%27","g");b=b.replace(a,"'");var a=new RegExp("%09","g");b=b.replace(a,"    ");var a=new RegExp("%7C","g");b=b.replace(a,"|");var a=new RegExp("%5B","g");b=b.replace(a,"[");var a=new RegExp("%5D","g");b=b.replace(a,"]");var a=new RegExp("%5C","g");b=b.replace(a,"\\");return b}function insertTags(g,a,b){var j=document.getElementById("edit-content");g=unescapeSpecial(g);if(document.selection){var k=document.selection.createRange().text;if(!k){k=b}j.focus();if(k.charAt(k.length-1)==" "){k=k.substring(0,k.length-1);document.selection.createRange().text=g+k+a+" "}else{document.selection.createRange().text=g+k+a}}else{if(j.selectionStart||j.selectionStart=="0"){var h=j.selectionStart;var c=j.selectionEnd;var e=j.scrollTop;var d=(j.value).substring(h,c);if(!d){d=b}if(d.charAt(d.length-1)==" "){subst=g+d.substring(0,(d.length-1))+a+" "}else{subst=g+d+a}j.value=j.value.substring(0,h)+subst+j.value.substring(c,j.value.length);j.focus();var l=h+(g.length+d.length+a.length);j.selectionStart=l;j.selectionEnd=l;j.scrollTop=e}else{j.value+=g+b+a;j.focus()}}if(j.createTextRange){j.caretPos=document.selection.createRange().duplicate()}}var f,sr_undo,replacewin,undo_buffer=new Array(),undo_buffer_index=0;function define_f(){f=document.getElementById("editpage");f.editarea=document.getElementById("edit-content");sr_undo=document.getElementById("sr_undo");undo_enable(false);f.editarea.focus()}function undo_enable(a){if(a){sr_undo.src=uri_undo_btn;sr_undo.alt=msg_undo_alt;sr_undo.disabled=false}else{sr_undo.src=uri_undo_d_btn;sr_undo.alt=msg_undo_d_alt;sr_undo.disabled=true;if(sr_undo.blur){sr_undo.blur()}}}function replace(){var a=120;var d=600;var c=(screen.height-a)/2;var b=(screen.width-d)/2;replacewin=window.open("","","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=yes,copyhistory=no,top="+c+",left="+b+",height="+a+",width="+d);replacewin.window.document.writeln(doctype);replacewin.window.document.writeln("<html>\n<head>\n<title>"+msg_repl_title+"</title>");replacewin.window.document.writeln(cssfile);replacewin.window.document.writeln("</head>");replacewin.window.document.writeln('<body onload="if(document.forms[0].searchinput.focus) document.forms[0].searchinput.focus(); return false;">\n<form action="">\n<center>\n<table>\n<tr>\n<td align="right">'+msg_repl_search+':\n</td>\n<td align="left">\n<input type="text" name="searchinput" size="45" maxlength="500" />\n</td>\n</tr>\n<tr>\n<td align="right">'+msg_repl_replace_with+':\n</td>\n<td align="left">\n<input type="text" name="replaceinput" size="45" maxlength="500" />\n</td>\n</tr>\n<tr>\n<td colspan="2" align="center">\n<input type="button" value=" '+msg_repl_ok+' " onclick="if(self.opener)self.opener.do_replace(); return false;" />&nbsp;&nbsp;&nbsp;<input type="button" value="'+msg_repl_close+'" onclick="self.close(); return false;" />\n</td>\n</tr>\n</table>\n</center>\n</form>\n</body>\n</html>');replacewin.window.document.close();return false}function do_replace(){var a=undo_buffer[undo_buffer_index]=f.editarea.value;var d=new RegExp(replacewin.document.forms[0].searchinput.value,"g");var b=replacewin.document.forms[0].replaceinput.value;if(d==""||d==null){if(replacewin){replacewin.window.document.forms[0].searchinput.focus()}return}var c=a.match(d)?a.match(d).length:0;a=a.replace(d,b);d=d.toString().substring(1,d.toString().length-2);msg_replfound=msg_replfound.replace("\1",d).replace("\2",c).replace("\3",b);msg_replnot=msg_replnot.replace("%s",d);result(c,msg_replfound,a,msg_replnot);replacewin.window.focus();replacewin.window.document.forms[0].searchinput.focus();return false}function result(c,a,d,b){if(c>0){if(window.confirm(a)==true){f.editarea.value=d;undo_save();undo_enable(true)}}else{alert(b)}}function do_undo(){if(undo_buffer_index==0){return}else{if(undo_buffer_index>0){f.editarea.value=undo_buffer[undo_buffer_index-1];undo_buffer[undo_buffer_index]=null;undo_buffer_index--;if(undo_buffer_index==0){alert(msg_do_undo);undo_enable(false)}}}}function undo_save(){undo_buffer[undo_buffer_index]=f.editarea.value;undo_buffer_index++;undo_enable(true)};